<UserControl x:Class="C_TestForge.UI.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:C_TestForge.UI.Views"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             Background="{StaticResource AppBackground}">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Phần chào mừng -->
            <materialDesign:Card Grid.Row="0" Margin="0,0,0,24" UniformCornerRadius="8"
                               Background="{StaticResource AccentColor}">
                <Grid>
                    <Image Source="/Resources/Images/dashboard-header-bg.jpg" Stretch="Fill" Opacity="0.2"/>
                    <StackPanel Margin="24">
                        <TextBlock Text="Chào mừng đến với C-TestForge" 
                                   FontSize="32" FontWeight="Light" Foreground="White"/>
                        <TextBlock Text="Công cụ phân tích mã nguồn C và sinh ca kiểm thử" 
                                   FontSize="18" Foreground="White" Opacity="0.9" Margin="0,8,0,0"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Thông tin dự án (1 dự án) -->
            <materialDesign:Card Grid.Row="1" Margin="0,0,0,24" UniformCornerRadius="8"
                   Visibility="{Binding HasProject, Converter={StaticResource BoolToVisibilityConverter}}"
                   materialDesign:ShadowAssist.ShadowDepth="Depth1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <!-- Biểu tượng dự án -->
                    <Border Grid.Column="0" Background="{StaticResource AccentLight}" Width="100">
                        <materialDesign:PackIcon Kind="FolderOpenOutline" Width="64" Height="64" 
                                               Foreground="White" HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                    </Border>
                    <!-- Chi tiết dự án -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="24,16">
                        <TextBlock Text="Dự án hiện tại" FontSize="14" Foreground="{StaticResource SecondaryText}"/>
                        <TextBlock Text="{Binding ProjectName}" FontSize="24" FontWeight="Medium" Margin="0,4,0,8"/>
                        <WrapPanel Orientation="Horizontal">
                            <StackPanel Orientation="Horizontal" Margin="0,0,24,0">
                                <materialDesign:PackIcon Kind="FileOutline" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding CurrentProject.SourceFiles.Count, StringFormat='{}{0} tệp nguồn'}" VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,24,0">
                                <materialDesign:PackIcon Kind="FileDocumentOutline" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding CurrentProject.ProjectFilePath}" VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,24,0">
                                <materialDesign:PackIcon Kind="CalendarClock" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding CurrentProject.LastModified, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </WrapPanel>
                        <TextBlock Text="{Binding CurrentProject.Description}" FontSize="14" Foreground="{StaticResource SecondaryText}" TextWrapping="Wrap" MaxWidth="500"/>
                    </StackPanel>
                    <Grid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Tạo dự án mới" Command="{Binding NewProjectCommand}"/>
                            <MenuItem Header="Chỉnh sửa dự án" Command="{Binding EditProjectCommand}"/>
                        </ContextMenu>
                    </Grid.ContextMenu>
                </Grid>
            </materialDesign:Card>
            
            <!-- Không có dự án nào -->
            <materialDesign:Card Grid.Row="1" Margin="0,0,0,24" UniformCornerRadius="8"
                   Visibility="{Binding HasProject, Converter={StaticResource InverseBooleanToVisibilityConverter}}"
                   materialDesign:ShadowAssist.ShadowDepth="Depth1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Trạng thái rỗng -->
                    <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="24,32,24,24">
                        <materialDesign:PackIcon Kind="FolderOpenOutline" Width="80" Height="80" 
                                               HorizontalAlignment="Center" Foreground="{StaticResource DisabledText}"/>
                        <TextBlock Text="Chưa có dự án nào" Style="{StaticResource HeadingStyle}"
                                 HorizontalAlignment="Center" Margin="0,16,0,8"/>
                        <TextBlock Text="Hãy bắt đầu bằng cách tạo mới hoặc mở một dự án có sẵn"
                                 Style="{StaticResource BodyTextStyle}" Foreground="{StaticResource SecondaryText}"
                                 HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center" 
                                 MaxWidth="400"/>
                    </StackPanel>
                    
                    <!-- Nút hành động -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,32">
                        <Button Content="Tạo dự án mới" Command="{Binding NewProjectCommand}"
                               Style="{StaticResource PrimaryButtonStyle}" Margin="8,0">
                            <Button.ContentTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="FilePlusOutline" Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </Button.ContentTemplate>
                        </Button>
                        <Button Content="Mở dự án" Command="{Binding OpenProjectCommand}"
                               Style="{StaticResource SecondaryButtonStyle}" Margin="8,0">
                            <Button.ContentTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="FolderOpenOutline" Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </Button.ContentTemplate>
                        </Button>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- ...các thẻ tính năng... -->
            <ItemsControl Grid.Row="2" Margin="0,0,0,24">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <!-- Phân tích mã nguồn -->
                <materialDesign:Card Style="{StaticResource ModernCardStyle}" Width="380" Height="220" Margin="0,8,16,8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="40" Height="40" Background="{StaticResource AccentLight}" 
                                   CornerRadius="20" Margin="0,0,16,0">
                                <materialDesign:PackIcon Kind="CodeBraces" Width="24" Height="24" 
                                                       Foreground="White" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Phân tích mã nguồn" FontSize="18" FontWeight="Medium" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Grid.Row="1" Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                            Phân tích cấu trúc mã nguồn C. Phát hiện biến, hàm, định nghĩa, điều kiện tiền xử lý để hỗ trợ sinh ca kiểm thử.
                        </TextBlock>
                        <Button Grid.Row="2" Content="Xem phân tích" HorizontalAlignment="Right" 
                               Style="{StaticResource SecondaryButtonStyle}"
                               Command="{Binding NavigateCommand}" CommandParameter="SourceAnalysis"/>
                    </Grid>
                </materialDesign:Card>
                <!-- Sinh ca kiểm thử -->
                <materialDesign:Card Style="{StaticResource ModernCardStyle}" Width="380" Height="220" Margin="0,8,16,8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="40" Height="40" Background="{StaticResource AccentLight}" 
                                   CornerRadius="20" Margin="0,0,16,0">
                                <materialDesign:PackIcon Kind="TestTube" Width="24" Height="24" 
                                                       Foreground="White" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Sinh ca kiểm thử" FontSize="18" FontWeight="Medium" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Grid.Row="1" Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                            Tự động sinh ca kiểm thử cho hàm dựa trên phân tích mã nguồn. Sử dụng Z3 Solver để tìm giá trị đầu vào tối ưu cho kiểm thử.
                        </TextBlock>
                        <Button Grid.Row="2" Content="Quản lý ca kiểm thử" HorizontalAlignment="Right" 
                               Style="{StaticResource SecondaryButtonStyle}"
                               Command="{Binding NavigateCommand}" CommandParameter="TestCases"/>
                    </Grid>
                </materialDesign:Card>
                <!-- Quản lý ánh xạ kiểu dữ liệu -->
                <materialDesign:Card Style="{StaticResource ModernCardStyle}" Width="380" Height="220" Margin="0,8,16,8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="40" Height="40" Background="{StaticResource AccentLight}" 
                                   CornerRadius="20" Margin="0,0,16,0">
                                <materialDesign:PackIcon Kind="SwapHorizontal" Width="24" Height="24" 
                                                       Foreground="White" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Quản lý ánh xạ kiểu dữ liệu" FontSize="18" FontWeight="Medium" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Grid.Row="1" Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                            Quản lý ánh xạ từ kiểu do người dùng định nghĩa sang kiểu cơ bản và khai báo ràng buộc giá trị cho từng kiểu dữ liệu để hỗ trợ sinh ca kiểm thử chính xác.
                        </TextBlock>
                        <Button Grid.Row="2" Content="Cấu hình kiểu dữ liệu" HorizontalAlignment="Right" 
                               Style="{StaticResource SecondaryButtonStyle}"
                               Command="{Binding NavigateCommand}" CommandParameter="TypeMappings"/>
                    </Grid>
                </materialDesign:Card>
                <!-- Phân tích hàm -->
                <materialDesign:Card Style="{StaticResource ModernCardStyle}" Width="380" Height="220" Margin="0,8,16,8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="40" Height="40" Background="{StaticResource AccentLight}" 
                                   CornerRadius="20" Margin="0,0,16,0">
                                <materialDesign:PackIcon Kind="Function" Width="24" Height="24" 
                                                       Foreground="White" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Phân tích hàm" FontSize="18" FontWeight="Medium" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Grid.Row="1" Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                            Phân tích chi tiết các hàm trong mã nguồn, gồm tham số, giá trị trả về, độ phức tạp và phụ thuộc giữa các hàm.
                        </TextBlock>
                        <Button Grid.Row="2" Content="Xem danh sách hàm" HorizontalAlignment="Right" 
                               Style="{StaticResource SecondaryButtonStyle}"
                               Command="{Binding NavigateCommand}" CommandParameter="Functions"/>
                    </Grid>
                </materialDesign:Card>
            </ItemsControl>
            
            <!-- Thông tin chân trang -->
            <Border Grid.Row="3" BorderBrush="{StaticResource BorderLight}" 
                   BorderThickness="0,1,0,0" Padding="0,20,0,0" Margin="0,8,0,0">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="C-TestForge v1.0" FontSize="14" Foreground="{StaticResource SecondaryText}"
                             HorizontalAlignment="Center"/>
                    <TextBlock Text="Phát triển với .NET 9 và ClangSharp" FontSize="12" 
                             Foreground="{StaticResource DisabledText}" HorizontalAlignment="Center" 
                             Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>